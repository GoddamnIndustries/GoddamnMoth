// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// A very simple linear algebra library and linear system solving library.
// Copyright (C) 2017 Butakov Oleg.
// All rights reserved.
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#include "Matrix.h"
#include "Test.h"

#if 0

#undef ALG_GENERATED_TEST_DATA
#define ALG_GENERATED_TEST_DATA 0
#if ALG_GENERATED_TEST_DATA
#	include <valarray>
#endif	// ALG_GENERATED_TEST_DATA

// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ //
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ //
// +++++                             Generic matrices.                            +++++ //
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ //
// ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ //

namespace
{
#if ALG_GENERATED_TEST_DATA
using vector7 = std::valarray<float64_t>;
using block_vector73 = std::valarray<std::valarray<float64_t>>;
#else	// ALG_GENERATED_TEST_DATA
using vector7 = alg_vector<float64_t>;
using block_vector73 = alg_vector<vector7>;
#endif	// ALG_GENERATED_TEST_DATA

#if ALG_GENERATED_TEST_DATA
using matrix7 = std::valarray<float64_t>;
using block_matrix73 = std::valarray<std::valarray<float64_t>>;
#else	// ALG_GENERATED_TEST_DATA
using matrix7 = alg_matrix<float64_t>;
using block_matrix73 = alg_matrix<matrix7>;
#endif	// ALG_GENERATED_TEST_DATA

#if ALG_GENERATED_TEST_DATA
static void print_matrix(const matrix7& matrix)
{
	for (size_t i = 0; i < 7; ++i)
	{
		for (size_t j = 0; j < 7; ++j)
		{
			printf("\t%.10f,", matrix[i * 7 + j]);
		}
		printf("\n");
	}
}
#endif	// ALG_GENERATED_TEST_DATA

template<typename T>
static auto& at(T& t, size_t i, size_t j)
{
}

// A utility null matrix.
static const matrix7 Z(0.0);

// A Toeplitz block tridiagonal matrix.
static const matrix7 Bdg = {
	0.0135787949,	0.0643695122,	0.6499764621,	0.1938959714,	0.2107144720,	0.8094894128,	0.0129520889,
	0.3587314589,	0.4733460130,	0.9531262614,	0.5954194075,	0.5895663591,	0.1523024954,	0.3828544190,
	0.9985214209,	0.8123250911,	0.4521111220,	0.7975027326,	0.4076412966,	0.6213960016,	0.1445718606,
	0.8728688487,	0.8608337677,	0.7301019538,	0.7981392535,	0.4453282452,	0.7649061871,	0.0004060396,
	0.5586944931,	0.3303881559,	0.9492604049,	0.3004395325,	0.3175752356,	0.3082150560,	0.5025477523,
	0.2511842582,	0.4047741951,	0.3266312704,	0.2494328066,	0.5485513340,	0.8681085189,	0.6111752127,
	0.3566853180,	0.9914141766,	0.5050911071,	0.6618675623,	0.5603111136,	0.6146439147,	0.6343042161,
};
static const matrix7 Bsb = {
	0.4386217109,	0.3467343485,	0.8950887360,	0.2982545256,	0.3361057192,	0.5456603335,	0.4336312456,
	0.7996953063,	0.7156798768,	0.7512871230,	0.0180680585,	0.1413807331,	0.3550744431,	0.6733880313,
	0.6225249559,	0.9212046475,	0.2328172004,	0.5220031202,	0.8782455266,	0.2874932214,	0.2727111190,
	0.4275511086,	0.6454881514,	0.4800241074,	0.2953101357,	0.4056977304,	0.2150129716,	0.5340000660,
	0.6195760457,	0.3010344429,	0.9509708139,	0.9584770002,	0.5667484259,	0.4405253464,	0.3507651765,
	0.0116838816,	0.4238423906,	0.5967664606,	0.1005713376,	0.2405767840,	0.5820972020,	0.7607930939,
	0.1613904044,	0.4528156884,	0.4130186137,	0.3970124684,	0.9588136222,	0.7368932266,	0.3146667797,
};
static const matrix7 Bsp = {
	0.0352687735,	0.9455219249,	0.5327611796,	0.6993122631,	0.0520371821,	0.8835958829,	0.4913442803,
	0.9346419957,	0.0285972457,	0.2221131513,	0.0325162553,	0.7324711302,	0.8894317257,	0.0194609706,
	0.7345615151,	0.7531523010,	0.5280791135,	0.4649009378,	0.1843640098,	0.1014406492,	0.7991050290,
	0.6251406078,	0.7207712123,	0.4509780682,	0.6412275507,	0.9834759776,	0.7746973577,	0.8966944481,
	0.6944103475,	0.1611171145,	0.6608465317,	0.8428101793,	0.6415068354,	0.7015996827,	0.9216620008,
	0.1371702058,	0.6297651769,	0.2205779440,	0.3134735983,	0.1372256495,	0.4995341983,	0.6037552423,
	0.6385931653,	0.6874771578,	0.9634037558,	0.9248560677,	0.4720274861,	0.0253439162,	0.5443299087,
};
static const block_matrix73 B = {
	Bdg, Bsp,  Z ,
	Bsb, Bdg, Bsp,
	 Z , Bsb, Bdg,
};

// A Toeplitz block tridiagonal matrix.
static const matrix7 Cdg = {
	0.4128224516,	0.5492340425,	0.4840136569,	0.7328309417,	0.8986399815,	0.2913273322,	0.9727259062,
	0.1508192134,	0.1824625289,	0.7601370062,	0.6012406168,	0.8089642379,	0.7745999399,	0.3682438845,
	0.9164856529,	0.7621921228,	0.3591665243,	0.9426629388,	0.4480713697,	0.7462135130,	0.0036671102,
	0.4306792266,	0.9812444444,	0.1809918298,	0.2555217842,	0.9834065962,	0.2537454429,	0.9355246284,
	0.0596886393,	0.2802830006,	0.9497486611,	0.8438345368,	0.5776180910,	0.2615132712,	0.6033837119,
	0.2030523594,	0.6744396764,	0.6405926874,	0.8324955697,	0.8947817497,	0.8796334937,	0.2773427936,
	0.9380640967,	0.4143336544,	0.3158034211,	0.5816122002,	0.4153261717,	0.0786356125,	0.9996303837,
};
static const matrix7 Csb = {
	0.6510235951,	0.8315114966,	0.9916545317,	0.5263442599,	0.0468498783,	0.0139934378,	0.4423976263,
	0.4146464434,	0.8171186340,	0.0190653933,	0.4689647900,	0.6971484539,	0.0070402291,	0.8567445907,
	0.2496386784,	0.0287367594,	0.4796635988,	0.8861350456,	0.0322121331,	0.3905268660,	0.7890329650,
	0.2906587272,	0.0705100851,	0.1832343575,	0.8536661934,	0.0985719718,	0.5012227157,	0.9069674322,
	0.0016069101,	0.3758816666,	0.8313036671,	0.4668081518,	0.3365518603,	0.5040176683,	0.9086417066,
	0.5815377057,	0.1492381004,	0.1786571542,	0.8602437457,	0.8438916408,	0.8671050174,	0.4341851142,
	0.9242762714,	0.1827182440,	0.3243973241,	0.3328253102,	0.3607648218,	0.7876185383,	0.1693934909,
};
static const matrix7 Csp = {
	0.5349174739,	0.8060948549,	0.1002817750,	0.3640432459,	0.6731191073,	0.0493323278,	0.4878348795,
	0.4166577675,	0.7732715170,	0.6518153028,	0.7086134695,	0.2874242131,	0.5145092914,	0.9874923108,
	0.4234588604,	0.6159244813,	0.5244790340,	0.7646444276,	0.7167071420,	0.0567691174,	0.9886184317,
	0.8785838118,	0.0934851168,	0.6080792486,	0.7920025935,	0.1662826407,	0.6324734906,	0.8188415337,
	0.6733037257,	0.6994708641,	0.8962190265,	0.8168621670,	0.5297656745,	0.1222848804,	0.3327617839,
	0.6208827839,	0.8931639330,	0.3345714345,	0.5645965603,	0.9853554850,	0.3620181615,	0.8597653204,
	0.1490202364,	0.9610060561,	0.8390387935,	0.7629994853,	0.1828057197,	0.6185642869,	0.3821633018,
};
static const block_matrix73 C = {
	Cdg, Csp,  Z ,
	Csb, Cdg, Csp,
	 Z , Csb, Cdg,
};

// ------------------------------------------------------------------------------------ //
// ------------------------------------------------------------------------------------ //

/// r := A ~= B
/// r := ||a||_L1.
/// r := ||a||_L2.
/// r := ||a||_LInf.

// ------------------------------------------------------------------------------------ //
// -----                         Matrix-Matrix operations.                        ----- //
// ------------------------------------------------------------------------------------ //

testing_unit_test(matrix_alg_add)
{
	static constexpr float64_t beta  = +1.0;
	static constexpr float64_t gamma = -2.0;
	static const matrix7 expected_Adg = {
		-0.8120661083,	-1.0340985728,	-0.3180508517,	-1.2717659120,	-1.5865654910,	+0.2268347484,	-1.9324997235,
		+0.0570930321,	+0.1084209552,	-0.5671477510,	-0.6070618261,	-1.0283621167,	-1.3968973844,	-0.3536333500,
		-0.8344498849,	-0.7120591545,	-0.2662219266,	-1.0878231450,	-0.4885014428,	-0.8710310244,	+0.1372376402,
		+0.0115103955,	-1.1016551211,	+0.3681182942,	+0.2870956851,	-1.5214849472,	+0.2574153013,	-1.8706432172,
		+0.4393172145,	-0.2301778453,	-0.9502369173,	-1.3872295411,	-0.8376609464,	-0.2148114864,	-0.7042196715,
		-0.1549204606,	-0.9441051577,	-0.9545541044,	-1.4155583328,	-1.2410121654,	-0.8911584685,	+0.0564896255,
		-1.5194428754,	+0.1627468678,	-0.1265157351,	-0.5013568381,	-0.2703412298,	+0.4573726897,	-1.3649565513,
	};
	static const matrix7 expected_Asb = {
		-0.8634254793,	-1.3162886447,	-1.0882203274,	-0.7544339942,	+0.2424059626,	+0.5176734579,	-0.4511640070,
		-0.0295975805,	-0.9185573912,	+0.7131563364,	-0.9198615215,	-1.2529161747,	+0.3409939849,	-1.0401011501,
		+0.1232475991,	+0.8637311287,	-0.7265099972,	-1.2502669710,	+0.8138212604,	-0.4935605106,	-1.3053548110,
		-0.1537663458,	+0.5044679812,	+0.1135553924,	-1.4120222511,	+0.2085537868,	-0.7874324598,	-1.2799347984,
		+0.6163622255,	-0.4507288903,	-0.7116365203,	+0.0248606966,	-0.1063552947,	-0.5675099902,	-1.4665182367,
		-1.1513915298,	+0.1253661898,	+0.2394521522,	-1.6199161538,	-1.4472064976,	-1.1521128328,	-0.1075771345,
		-1.6871621384,	+0.0873792004,	-0.2357760345,	-0.2686381520,	+0.2372839786,	-0.8383438500,	-0.0241202021,
	};
	static const matrix7 expected_Asp = {
		-1.0345661743,	-0.6666677849,	+0.3321976296,	-0.0287742287,	-1.2942010325,	+0.7849312273,	-0.4843254787,
		+0.1013264607,	-1.5179457883,	-1.0815174543,	-1.3847106837,	+0.1576227040,	-0.1395868571,	-1.9555236510,
		-0.1123562057,	-0.4786966616,	-0.5208789545,	-1.0643879174,	-1.2490502742,	-0.0120975856,	-1.1781318344,
		-1.1320270158,	+0.5338009787,	-0.7651804290,	-0.9427776363,	+0.6509106962,	-0.4902496235,	-0.7409886193,
		-0.6521971039,	-1.2378246137,	-1.1315915213,	-0.7909141547,	-0.4180245136,	+0.4570299219,	+0.2561384330,
		-1.1045953620,	-1.1565626891,	-0.4485649250,	-0.8157195223,	-1.8334853205,	-0.2245021247,	-1.1157753985,
		+0.3405526925,	-1.2345349544,	-0.7146738312,	-0.6011429029,	+0.1064160467,	-1.2117846576,	-0.2199966949,
	};
	static const block_matrix73 expected_A = {
		expected_Adg, expected_Asp,      Z,
		expected_Asb, expected_Adg, expected_Asp,
		     Z,       expected_Asb, expected_Adg
	};

	block_matrix73 A;
	//alg_add(A, beta, B, gamma, C);
	//testing_verify(alg_near_eql(A, expected_A));
};

testing_unit_test(matrix_alg_add_assign)
{
	static constexpr float64_t gamma = -2.0;
	static const matrix7 expected_Adg = {
		-0.8120661083,	-1.0340985728,	-0.3180508517,	-1.2717659120,	-1.5865654910,	+0.2268347484,	-1.9324997235,
		+0.0570930321,	+0.1084209552,	-0.5671477510,	-0.6070618261,	-1.0283621167,	-1.3968973844,	-0.3536333500,
		-0.8344498849,	-0.7120591545,	-0.2662219266,	-1.0878231450,	-0.4885014428,	-0.8710310244,	+0.1372376402,
		+0.0115103955,	-1.1016551211,	+0.3681182942,	+0.2870956851,	-1.5214849472,	+0.2574153013,	-1.8706432172,
		+0.4393172145,	-0.2301778453,	-0.9502369173,	-1.3872295411,	-0.8376609464,	-0.2148114864,	-0.7042196715,
		-0.1549204606,	-0.9441051577,	-0.9545541044,	-1.4155583328,	-1.2410121654,	-0.8911584685,	+0.0564896255,
		-1.5194428754,	+0.1627468678,	-0.1265157351,	-0.5013568381,	-0.2703412298,	+0.4573726897,	-1.3649565513,
	};
	static const matrix7 expected_Asb = {
		-0.8634254793,	-1.3162886447,	-1.0882203274,	-0.7544339942,	+0.2424059626,	+0.5176734579,	-0.4511640070,
		-0.0295975805,	-0.9185573912,	+0.7131563364,	-0.9198615215,	-1.2529161747,	+0.3409939849,	-1.0401011501,
		+0.1232475991,	+0.8637311287,	-0.7265099972,	-1.2502669710,	+0.8138212604,	-0.4935605106,	-1.3053548110,
		-0.1537663458,	+0.5044679812,	+0.1135553924,	-1.4120222511,	+0.2085537868,	-0.7874324598,	-1.2799347984,
		+0.6163622255,	-0.4507288903,	-0.7116365203,	+0.0248606966,	-0.1063552947,	-0.5675099902,	-1.4665182367,
		-1.1513915298,	+0.1253661898,	+0.2394521522,	-1.6199161538,	-1.4472064976,	-1.1521128328,	-0.1075771345,
		-1.6871621384,	+0.0873792004,	-0.2357760345,	-0.2686381520,	+0.2372839786,	-0.8383438500,	-0.0241202021,
	};
	static const matrix7 expected_Asp = {
		-1.0345661743,	-0.6666677849,	+0.3321976296,	-0.0287742287,	-1.2942010325,	+0.7849312273,	-0.4843254787,
		+0.1013264607,	-1.5179457883,	-1.0815174543,	-1.3847106837,	+0.1576227040,	-0.1395868571,	-1.9555236510,
		-0.1123562057,	-0.4786966616,	-0.5208789545,	-1.0643879174,	-1.2490502742,	-0.0120975856,	-1.1781318344,
		-1.1320270158,	+0.5338009787,	-0.7651804290,	-0.9427776363,	+0.6509106962,	-0.4902496235,	-0.7409886193,
		-0.6521971039,	-1.2378246137,	-1.1315915213,	-0.7909141547,	-0.4180245136,	+0.4570299219,	+0.2561384330,
		-1.1045953620,	-1.1565626891,	-0.4485649250,	-0.8157195223,	-1.8334853205,	-0.2245021247,	-1.1157753985,
		+0.3405526925,	-1.2345349544,	-0.7146738312,	-0.6011429029,	+0.1064160467,	-1.2117846576,	-0.2199966949,
	};
	static const block_matrix73 expected_A = {
		expected_Adg, expected_Asp,      Z,
		expected_Asb, expected_Adg, expected_Asp,
		     Z,       expected_Asb, expected_Adg
	};

	block_matrix73 A(B);
	//alg_add_assign(A, gamma, C);
	//testing_verify(alg_near_eql(A, expected_A));
};

// ------------------------------------------------------------------------------------ //
// ------------------------------------------------------------------------------------ //

testing_unit_test(matrix_alg_sub)
{
	static constexpr float64_t beta  = +1.0;
	static constexpr float64_t gamma = -2.0;
	static const matrix7 expected_Adg = {
		-0.8120661083,	-1.0340985728,	-0.3180508517,	-1.2717659120,	-1.5865654910,	+0.2268347484,	-1.9324997235,
		+0.0570930321,	+0.1084209552,	-0.5671477510,	-0.6070618261,	-1.0283621167,	-1.3968973844,	-0.3536333500,
		-0.8344498849,	-0.7120591545,	-0.2662219266,	-1.0878231450,	-0.4885014428,	-0.8710310244,	+0.1372376402,
		+0.0115103955,	-1.1016551211,	+0.3681182942,	+0.2870956851,	-1.5214849472,	+0.2574153013,	-1.8706432172,
		+0.4393172145,	-0.2301778453,	-0.9502369173,	-1.3872295411,	-0.8376609464,	-0.2148114864,	-0.7042196715,
		-0.1549204606,	-0.9441051577,	-0.9545541044,	-1.4155583328,	-1.2410121654,	-0.8911584685,	+0.0564896255,
		-1.5194428754,	+0.1627468678,	-0.1265157351,	-0.5013568381,	-0.2703412298,	+0.4573726897,	-1.3649565513,
	};
	static const matrix7 expected_Asb = {
		-0.8634254793,	-1.3162886447,	-1.0882203274,	-0.7544339942,	+0.2424059626,	+0.5176734579,	-0.4511640070,
		-0.0295975805,	-0.9185573912,	+0.7131563364,	-0.9198615215,	-1.2529161747,	+0.3409939849,	-1.0401011501,
		+0.1232475991,	+0.8637311287,	-0.7265099972,	-1.2502669710,	+0.8138212604,	-0.4935605106,	-1.3053548110,
		-0.1537663458,	+0.5044679812,	+0.1135553924,	-1.4120222511,	+0.2085537868,	-0.7874324598,	-1.2799347984,
		+0.6163622255,	-0.4507288903,	-0.7116365203,	+0.0248606966,	-0.1063552947,	-0.5675099902,	-1.4665182367,
		-1.1513915298,	+0.1253661898,	+0.2394521522,	-1.6199161538,	-1.4472064976,	-1.1521128328,	-0.1075771345,
		-1.6871621384,	+0.0873792004,	-0.2357760345,	-0.2686381520,	+0.2372839786,	-0.8383438500,	-0.0241202021,
	};
	static const matrix7 expected_Asp = {
		-1.0345661743,	-0.6666677849,	+0.3321976296,	-0.0287742287,	-1.2942010325,	+0.7849312273,	-0.4843254787,
		+0.1013264607,	-1.5179457883,	-1.0815174543,	-1.3847106837,	+0.1576227040,	-0.1395868571,	-1.9555236510,
		-0.1123562057,	-0.4786966616,	-0.5208789545,	-1.0643879174,	-1.2490502742,	-0.0120975856,	-1.1781318344,
		-1.1320270158,	+0.5338009787,	-0.7651804290,	-0.9427776363,	+0.6509106962,	-0.4902496235,	-0.7409886193,
		-0.6521971039,	-1.2378246137,	-1.1315915213,	-0.7909141547,	-0.4180245136,	+0.4570299219,	+0.2561384330,
		-1.1045953620,	-1.1565626891,	-0.4485649250,	-0.8157195223,	-1.8334853205,	-0.2245021247,	-1.1157753985,
		+0.3405526925,	-1.2345349544,	-0.7146738312,	-0.6011429029,	+0.1064160467,	-1.2117846576,	-0.2199966949,
	};
	static const block_matrix73 expected_A = {
		expected_Adg, expected_Asp,      Z,
		expected_Asb, expected_Adg, expected_Asp,
		     Z,       expected_Asb, expected_Adg
	};

	block_matrix73 A;
	/*alg_sub(A, beta, B, gamma, C);
	testing_verify(alg_near_eql(A, expected_A));*/
};

testing_unit_test(matrix_alg_sub_assign)
{
	static constexpr float64_t gamma = -2.0;
	static const matrix7 expected_Adg = {
		-0.8120661083,	-1.0340985728,	-0.3180508517,	-1.2717659120,	-1.5865654910,	+0.2268347484,	-1.9324997235,
		+0.0570930321,	+0.1084209552,	-0.5671477510,	-0.6070618261,	-1.0283621167,	-1.3968973844,	-0.3536333500,
		-0.8344498849,	-0.7120591545,	-0.2662219266,	-1.0878231450,	-0.4885014428,	-0.8710310244,	+0.1372376402,
		+0.0115103955,	-1.1016551211,	+0.3681182942,	+0.2870956851,	-1.5214849472,	+0.2574153013,	-1.8706432172,
		+0.4393172145,	-0.2301778453,	-0.9502369173,	-1.3872295411,	-0.8376609464,	-0.2148114864,	-0.7042196715,
		-0.1549204606,	-0.9441051577,	-0.9545541044,	-1.4155583328,	-1.2410121654,	-0.8911584685,	+0.0564896255,
		-1.5194428754,	+0.1627468678,	-0.1265157351,	-0.5013568381,	-0.2703412298,	+0.4573726897,	-1.3649565513,
	};
	static const matrix7 expected_Asb = {
		-0.8634254793,	-1.3162886447,	-1.0882203274,	-0.7544339942,	+0.2424059626,	+0.5176734579,	-0.4511640070,
		-0.0295975805,	-0.9185573912,	+0.7131563364,	-0.9198615215,	-1.2529161747,	+0.3409939849,	-1.0401011501,
		+0.1232475991,	+0.8637311287,	-0.7265099972,	-1.2502669710,	+0.8138212604,	-0.4935605106,	-1.3053548110,
		-0.1537663458,	+0.5044679812,	+0.1135553924,	-1.4120222511,	+0.2085537868,	-0.7874324598,	-1.2799347984,
		+0.6163622255,	-0.4507288903,	-0.7116365203,	+0.0248606966,	-0.1063552947,	-0.5675099902,	-1.4665182367,
		-1.1513915298,	+0.1253661898,	+0.2394521522,	-1.6199161538,	-1.4472064976,	-1.1521128328,	-0.1075771345,
		-1.6871621384,	+0.0873792004,	-0.2357760345,	-0.2686381520,	+0.2372839786,	-0.8383438500,	-0.0241202021,
	};
	static const matrix7 expected_Asp = {
		-1.0345661743,	-0.6666677849,	+0.3321976296,	-0.0287742287,	-1.2942010325,	+0.7849312273,	-0.4843254787,
		+0.1013264607,	-1.5179457883,	-1.0815174543,	-1.3847106837,	+0.1576227040,	-0.1395868571,	-1.9555236510,
		-0.1123562057,	-0.4786966616,	-0.5208789545,	-1.0643879174,	-1.2490502742,	-0.0120975856,	-1.1781318344,
		-1.1320270158,	+0.5338009787,	-0.7651804290,	-0.9427776363,	+0.6509106962,	-0.4902496235,	-0.7409886193,
		-0.6521971039,	-1.2378246137,	-1.1315915213,	-0.7909141547,	-0.4180245136,	+0.4570299219,	+0.2561384330,
		-1.1045953620,	-1.1565626891,	-0.4485649250,	-0.8157195223,	-1.8334853205,	-0.2245021247,	-1.1157753985,
		+0.3405526925,	-1.2345349544,	-0.7146738312,	-0.6011429029,	+0.1064160467,	-1.2117846576,	-0.2199966949,
	};
	static const block_matrix73 expected_A = {
		expected_Adg, expected_Asp,      Z,
		expected_Asb, expected_Adg, expected_Asp,
		     Z,       expected_Asb, expected_Adg
	};

	block_matrix73 A(B);
	/*alg_sub_assign(A, gamma, C);
	testing_verify(alg_near_eql(A, expected_A));*/
};

// ------------------------------------------------------------------------------------ //
// ------------------------------------------------------------------------------------ //

testing_unit_test(matrix_alg_mul_constant_matrix)
{
	static constexpr float64_t beta = +13.0;
	static const matrix7 expected_Adg = {
		 0.1765243337,	 0.8368036586,	 8.4496940073,	 2.5206476282,	 2.7392881360,	10.5233623664,	 0.1683771557,
		 4.6635089657,	 6.1534981690,	12.3906413982,	 7.7404522975,	 7.6643626683,	 1.9799324402,	 4.9771074470,
		12.9807784717,  10.5602261843,	 5.8774445860,	10.3675355238,	 5.2993368558,	 8.0781480208,	 1.8794341878,
		11.3472950331,  11.1908389801,	 9.4913253994,	10.3758102955,	 5.7892671876,	 9.9437804323,	 0.0052785148,
		 7.2630284103,	 4.2950460267,	12.3403852637,	 3.9057139225,	 4.1284780628,	4.0067957280,	 6.5331207799,
		 3.2653953566,	 5.2620645363,	 4.2462065152,	 3.2426264858,	 7.1311673420,	11.2854107457,	 7.9452777651,
		 4.6369091340,	12.8883842958,	 6.5661843923,	 8.6042783099,	 7.2840444768,	 7.9903708911,	 8.2459548093,
	};
	static const matrix7 expected_Asb = {
		 5.7020822417,	 4.5075465305,	11.6361535680,	 3.8773088328,	 4.3693743496,	 7.0935843355,	 5.6372061928,
		10.3960389819,	 9.3038383984,	 9.7667325990,	 0.2348847605,	 1.8379495303,	 4.6159677603,	 8.7540444069,
		 8.0928244267,	11.9756604175,	 3.0266236052,	 6.7860405626,	11.4171918458,	 3.7374118782,	 3.5452445470,
		 5.5581644118,	 8.3913459682,	 6.2403133962,	 3.8390317641,	 5.2740704952,	 2.7951686308,	 6.9420008580,
		 8.0544885941,	 3.9134477577,	12.3626205807,	12.4602010026,	 7.3677295367,	 5.7268295032,	 4.5599472945,
		 0.1518904608,	 5.5099510778,	 7.7579639878,	 1.3074273888,	 3.1274981920,	 7.5672636260,	 9.8903102207,
		 2.0980752572,	 5.8866039492,	 5.3692419781,	 5.1611620892,	12.4645770886,	 9.5796119458,	 4.0906681361,
	};
	static const matrix7 expected_Asp = {
		 0.4584940555,	12.2917850237,	 6.9258953348,	 9.0910594203,   0.6764833673,  11.4867464777,   6.3874756439,
		12.1503459441,	 0.3717641941,	 2.8874709669,	 0.4227113189,   9.5221246926,  11.5626124341,   0.2529926178,
		 9.5492996963,	 9.7909799130,	 6.8650284755,	 6.0437121914,   2.3967321274,   1.3187284396,  10.3883653770,
		 8.1268279014,	 9.3700257599,	 5.8627148866,	 8.3359581591,  12.7851877088,  10.0710656501,  11.6570278253,
		 9.0273345175,	 2.0945224885,	 8.5910049121,	10.9565323309,   8.3395888602,   9.1207958751,  11.9816060104,
		 1.7832126754,	 8.1869472997,	 2.8675132720,	 4.0751567779,   1.7839334435,   6.4939445779,   7.8488181499,
		 8.3017111489,	 8.9372030514,	12.5242488254,  12.0231288801,   6.1363573193,   0.3294709106,   7.0762888131,
	};
	static const block_matrix73 expected_A = {
		expected_Adg, expected_Asp,      Z,
		expected_Asb, expected_Adg, expected_Asp,
		     Z,       expected_Asb, expected_Adg
	};

	block_matrix73 A;
	/*alg_mul(A, beta, B);
	testing_verify(alg_near_eql(A, expected_A));*/
};

testing_unit_test(matrix_alg_mul_constant_matrix_matrix)
{
	static constexpr float64_t beta = +13.0;
};

// ------------------------------------------------------------------------------------ //
// -----                        System solving operations.                        ----- //
// ------------------------------------------------------------------------------------ //

//testing_unit_test(matrix_alg_itersolve)
//{
//	static const vector7 expected_Bdg_inv = {
//		-1.1407560996,
//		-1.9460115019,
//		+0.1808733996,
//		+3.6585423503,
//		-2.7011024690,
//		+1.0737062116,
//		+1.0671173490,
//	};
//	static const vector7 f = {
//		1,0,0,0,0,0,0
//	};
//
//	vector7 Bdg_inv;
//	alg_solve_system_iter(Bdg_inv, Bdg, f, 0.001);
//	testing_verify(alg_near_eql(Bdg_inv, expected_Bdg_inv));
//};

// ------------------------------------------------------------------------------------ //
// -----                       Matrix inversion operations.                       ----- //
// ------------------------------------------------------------------------------------ //

//using vector3 = alg_vector<float64_t, 3>;
//using matrix3 = alg_matrix<float64_t, 3>;
//testing_unit_test(matrix_solve_system)
//{
//	vector3 x,y;
//	const matrix3 A = {
//		+1.0, +2.0, +3.0,
//		+4.0, +5.0, +6.0,
//		+7.0, +8.0, +9.0,
//	};
//	const vector3 f = {
//		+1.0,
//		+4.0,
//		+7.0,
//	};
//	const vector3 r = {
//		+1.0,
//		+0.0,
//		+0.0
//	};
//
//	bool equals;
//	//alg_solve_system(x, A, f);
//	alg_solve_system_iter(y, A, f);
//	equals = alg_near_eql(x, r);
//	testing_verify(equals);
//};

testing_unit_test(matrix_alg_inverse)
{
	static const matrix7 expected_Bdg_inv = {
		-1.1407560996,	-0.4118129689,	+0.2064968059,	+0.8320723858,	+0.8269428415,	+0.8386302340,	-1.2389641286,
		-1.9460115019,	-1.2436696382,	-3.9976975056,	+4.2540362006,	+0.5952370695,	+0.2070838537,	+1.0277040635,
		+0.1808733996,	-0.0301734601,	-1.3107517612,	+1.0333393467,	+0.9243656117,	-0.5242810808,	+0.0854122322,
		+3.6585423503,	+1.4117596770,	+6.5220149963,	-6.9160613524,	-1.5090470336,	-2.6400093143,	+1.3304351176,
		-2.7011024690,	+1.9528879408,	-3.2751830388,	+3.9398410179,	-1.4505325305,	+3.2068432625,	-2.3202881160,
		+1.0737062116,	-0.7115253804,	+0.6145364505,	-0.4912761039,	-0.0771672671,	+0.1984033857,	+0.1377567739,
		+1.0671173490,	-0.3092653431,	+2.6682131640,	-3.7273762772,	+0.7992938838,	-0.6480550845,	+1.1268078731,
	};

	matrix7 Bdg_inv;
	alg_inverse(Bdg_inv, Bdg);
	testing_verify(alg_near_eql(Bdg_inv, expected_Bdg_inv));
};

}

#endif
